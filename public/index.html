<!DOCTYPE html>
<html lang="en">

<head>
    <title>Valoliam</title>

    <link href="/css/button.css" rel="stylesheet" type="text/css">

    <link href="http://fonts.cdnfonts.com/css/valorant" rel="stylesheet">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
</head>

<body>

    <div class="heading-block">

        <h1 style="font-family: 'VALORANT', sans-serif;">Valoliam</h1>

        <div class="w3-center">








            <button class="btn btn--yellow" id="myBtn" name="myname" value="1"
                onclick="myFunction(this.value);this.disabled=true; ">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>

            <button class="btn btn--blue" id="myBtn" name="myname" value="2"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>

            <button class="btn btn--red" id="myBtn" name="myname" value="3"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>

            <button class="btn btn--light" id="myBtn" name="myname" value="4"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>



            <button class="btn btn--green" id="myBtn" name="myname" value="5"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>

            <button class="btn btn--ocean" id="myBtn" name="myname" value="6"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>

            <button class="btn btn--purple" id="myBtn" name="myname" value="7"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>

            <button class="btn btn--pink" id="myBtn" name="myname" value="8"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>



            <button class="btn btn--rainbow" id="myBtn" name="myname" value="9"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>


            <button class="btn btn--skymax" id="myBtn" name="myname" value="10"
                onclick="myFunction(this.value);this.disabled=true;">

                <span class="btn__inner">
                    <span class="btn__slide"></span>
                    <span class="btn__content"> </span>
                </span>
            </button>





        </div>
        <span id="pressed"></span>


        <br />
        <span id="datashop"></span>

        <a class="btn" href="#"
            onclick="document.getElementById('documentation').innerHTML='เติมเงินอะไรซักอย่าง'">เติมเงิน </a>
        <a class="btn" href="#"
            onclick="document.getElementById('documentation').innerHTML='ขายไอดีอะไรซักอย่าง'">ขายไอดี </a>
        <a class="btn" href="#" onclick="document.getElementById('documentation').innerHTML='สอบถามอะไรซักอย่าง'">สอบถาม
        </a>
        <span id="documentation"></span>


        <div>
            <a class="btn" href="#" id="btn_prev">ก่อนหน้า</a>
            <a class="btn" href="#" id="btn_next">หน้าต่อไป</a>
            หน้าที่: <span id="page"></span>
        </div>

    </div>



    <br />
    <br />
    <div id="listingTable"></div>



    <br />


    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

    <script>
        var socket = io();
        let facebookname;
        function alertfunction() {

            let facebook = prompt("กรุณากรอกชื่อเฟสของท่าน:", "");
            if (facebook == null || facebook == "") {
                facebookname = "ผู้ใช้กดยกเลิกการกรอกชื่อเฟส";
            } else {
                facebookname = facebook;
            }

        }


        $.ajax({
            url: "/datashop",
            // Handle as Text
            dataType: "text",
            success: function (data) {













                // Parse JSON file
                var json = $.parseJSON(data);
                //Store data into a variable
                // Display Players
                //
                var objJson = json
                // $('#results').html('Currently there are: ' + json.players.online + '  users');
                console.log("json " + json)









                var current_page = 1;
                var records_per_page = 5;


                function prevPage() {
                    if (current_page > 1) {
                        current_page--;
                        changePage(current_page);
                    }
                }

                function nextPage() {
                    if (current_page < numPages()) {
                        current_page++;
                        changePage(current_page);
                    }
                }

                function changePage(page) {

                    console.log("page" + page)

                    var btn_next = document.getElementById("btn_next");
                    var btn_prev = document.getElementById("btn_prev");
                    var listing_table = document.getElementById("listingTable");
                    var page_span = document.getElementById("page");

                    page_span.innerHTML = page;



                    if (page == 1) {
                        btn_prev.style.visibility = "hidden";
                    } else {
                        btn_prev.style.visibility = "visible";
                    }

                    if (page == numPages()) {
                        btn_next.style.visibility = "hidden";
                    } else {
                        btn_next.style.visibility = "visible";
                    }



                    // Validate page
                    if (page < 1) page = 1;
                    if (page > numPages()) page = numPages();

                    listing_table.innerHTML = "";

                    for (var i = (page - 1) * records_per_page; i < (page * records_per_page); i++) {

                        listing_table.innerHTML += "<hr><br>" + objJson[i].name + "<br>" + "<img src='" + objJson[i].url + "'alt='id-game image' width='420' height='210' " + "<br><br>";
                        console.log(i)
                    }




                }

                function numPages() {
                    return Math.ceil(objJson.length / records_per_page);
                }


                window.onload = function () {
                    changePage(1);
                    console.log("window")
                    document.getElementById("btn_next").onclick = function allfunction() {

                        nextPage();
                        //validation code to see State field is mandatory.  
                    }
                    document.getElementById("btn_prev").onclick = function allfunction() {

                        prevPage();
                        //validation code to see State field is mandatory.  
                    }
                }



            }

        });





















        function myFunction(value) {
            alertfunction()


            const obj = { name: facebookname, id: value, city: "New York" };


            console.log('function')

            socket.emit('chat message', obj);



            console.log('chat')

            document.getElementById('pressed').innerHTML = 'ท่านได้กดปุ่มสั่งซื้อเรียบร้อยแล้วหากต้องการสั่งซื้อใหม่ กรุณารีเฟรสเว็ปอีกครั้ง'
        }







    </script>



</body>

</html>